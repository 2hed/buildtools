<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="12.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <UsingTask TaskName="GenerateEncodingTable" AssemblyFile="$(ToolsDir)Microsoft.DotNet.Build.Tasks.dll" />

  <!--
       Include the following in the .csproj of a project which needs to generate an encoding data-table:
       <PropertyGroup>
         <IANAMappingPath>nameOfMappingFile</IANAMappingPath>
         <PreferredIANANamesPath>nameOfPreferredNameFile</PreferredIANANamesPath>
         <OutputDataTablePath>nameOfOutputFile</OutputDataTablePath>
       </PropertyGroup>
       <Import Project="$(ToolsDir)encoding.targets" Condition="Exists('$(ToolsDir)encoding.targets')" />
  -->

  <Target Name="GenerateEncodingSource"
          Condition="'$(OutputDataTablePath)'!='' And '$(IANAMappingPath)'!='' And Exists('$(IANAMappingPath)') And '$(PreferredIANANamesPath)'!='' And Exists('$(PreferredIANANamesPath)')"
          Inputs="$(IANAMappingPath);$(PreferredIANANamesPath)"
          Outputs="$(OutputDataTablePath)">

    <GenerateEncodingTable
        IANAMappings="$(IANAMappingPath)"
        PreferedIANANames="$(PreferredIANANamesPath)"
        OutputDataTable="$(OutputDataTablePath)"
        BuildProjectDirectory="$(MSBuildProjectDirectory)\"
        Namespace="$(Namespace)"
        ClassName="$(Classname)" />
  </Target>
</Project>
